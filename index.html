<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Skincare Quiz</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            -webkit-font-smoothing: antialiased;
        }
        #root {
            width: 100%;
            min-height: 100vh;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // ========== CUSTOMIZE YOUR COLORS HERE ==========
        const COLORS = {
            primary: '#00B900',
            secondary: '#06C755',
            accent: '#FFB800',
            background: '#FFFFFF',
            cardBg: '#F7F7F7',
            text: '#111111',
            textLight: '#666666'
        };

        // ========== CUSTOMIZE YOUR QUIZ QUESTIONS HERE ==========
        const quizData = [
            {
                id: 1,
                question: "What's your scalp type?",
                image: "https://images.unsplash.com/photo-1522338140262-f46f5913618a?w=400&h=300&fit=crop",
                options: [
                    { id: 'oily', label: 'Oily Scalp', variable: 'scalpType' },
                    { id: 'dry', label: 'Dry Scalp', variable: 'scalpType' },
                    { id: 'normal', label: 'Normal Scalp', variable: 'scalpType' }
                ]
            },
            {
                id: 2,
                question: "What's your hair texture?",
                image: "https://images.unsplash.com/photo-1560066984-138dadb4c035?w=400&h=300&fit=crop",
                options: [
                    { id: 'fine', label: 'Fine Hair', variable: 'hairTexture' },
                    { id: 'medium', label: 'Medium Hair', variable: 'hairTexture' },
                    { id: 'thick', label: 'Thick Hair', variable: 'hairTexture' }
                ]
            },
            {
                id: 3,
                question: "What's your hair type?",
                image: "https://images.unsplash.com/photo-1562322140-8baeececf3df?w=400&h=300&fit=crop",
                options: [
                    { id: 'straight', label: 'Straight', variable: 'hairType' },
                    { id: 'wavy', label: 'Wavy', variable: 'hairType' },
                    { id: 'curly', label: 'Curly', variable: 'hairType' },
                    { id: 'coily', label: 'Coily', variable: 'hairType' }
                ]
            },
            {
                id: 4,
                question: "What's your main hair concern?",
                image: "https://images.unsplash.com/photo-1519699047748-de8e457a634e?w=400&h=300&fit=crop",
                options: [
                    { id: 'frizz', label: 'Frizz Control', variable: 'hairConcern' },
                    { id: 'damage', label: 'Damage Repair', variable: 'hairConcern' },
                    { id: 'volume', label: 'Volume Boost', variable: 'hairConcern' },
                    { id: 'hydration', label: 'Hydration', variable: 'hairConcern' }
                ]
            },
            {
                id: 5,
                question: "How often do you wash your hair?",
                image: "https://images.unsplash.com/photo-1526045478516-99145907023c?w=400&h=300&fit=crop",
                options: [
                    { id: 'daily', label: 'Daily', variable: 'washFrequency' },
                    { id: 'every2days', label: 'Every 2-3 days', variable: 'washFrequency' },
                    { id: 'weekly', label: 'Once a week', variable: 'washFrequency' }
                ]
            },
            {
                id: 6,
                question: "What's your styling routine?",
                image: "https://images.unsplash.com/photo-1580618672591-eb180b1a973f?w=400&h=300&fit=crop",
                options: [
                    { id: 'minimal', label: 'Minimal (air dry)', variable: 'stylingRoutine' },
                    { id: 'moderate', label: 'Moderate (blow dry)', variable: 'stylingRoutine' },
                    { id: 'intensive', label: 'Intensive (heat tools)', variable: 'stylingRoutine' }
                ]
            },
            {
                id: 7,
                question: "Do you color treat your hair?",
                image: "https://images.unsplash.com/photo-1582095133179-bfd08e2fc6b3?w=400&h=300&fit=crop",
                options: [
                    { id: 'yes', label: 'Yes, regularly', variable: 'colorTreated' },
                    { id: 'sometimes', label: 'Occasionally', variable: 'colorTreated' },
                    { id: 'no', label: 'No', variable: 'colorTreated' }
                ]
            },
            {
                id: 8,
                question: "What's your budget preference?",
                image: "https://images.unsplash.com/photo-1591216314942-a397f33b8961?w=400&h=300&fit=crop",
                options: [
                    { id: 'budget', label: 'Budget-friendly', variable: 'budgetPreference' },
                    { id: 'mid', label: 'Mid-range', variable: 'budgetPreference' },
                    { id: 'premium', label: 'Premium', variable: 'budgetPreference' }
                ]
            }
        ];

        const ChevronRight = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="9 18 15 12 9 6"></polyline>
            </svg>
        );

        const Package = () => (
            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <line x1="16.5" y1="9.4" x2="7.5" y2="4.21"></line>
                <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
                <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
                <line x1="12" y1="22.08" x2="12" y2="12"></line>
            </svg>
        );

        const SkinCareQuiz = () => {
            const [currentQ, setCurrentQ] = useState(0);
            const [answers, setAnswers] = useState({});
            const [isComplete, setIsComplete] = useState(false);
            const [selectedOption, setSelectedOption] = useState(null);
            const [liffReady, setLiffReady] = useState(false);

            useEffect(() => {
                // Initialize LIFF
                if (typeof liff !== 'undefined') {
                    liff.init({ liffId: 'YOUR_LIFF_ID_HERE' })
                        .then(() => {
                            setLiffReady(true);
                            console.log('LIFF initialized');
                        })
                        .catch((err) => {
                            console.error('LIFF initialization failed', err);
                        });
                } else {
                    console.log('LIFF not available - running in preview mode');
                }
            }, []);

            const handleOptionSelect = (option) => {
                setSelectedOption(option.id);
                setAnswers({
                    ...answers,
                    [option.variable]: option.id
                });
            };

            const handleNext = () => {
                if (!selectedOption) return;
                
                if (currentQ < quizData.length - 1) {
                    setCurrentQ(currentQ + 1);
                    setSelectedOption(null);
                } else {
                    setIsComplete(true);
                }
            };

            const handleRestart = () => {
                setCurrentQ(0);
                setAnswers({});
                setIsComplete(false);
                setSelectedOption(null);
            };

            // ========== CUSTOMIZE YOUR PRODUCT RECOMMENDATIONS HERE ==========
            const getRecommendations = () => {
                const recommendations = [];
                
                // Example logic - customize based on your products
                if (answers.scalpType === 'oily' && answers.hairTexture === 'fine') {
                    recommendations.push('Volumizing Clarifying Shampoo');
                }
                if (answers.hairType === 'curly' && answers.hairConcern === 'frizz') {
                    recommendations.push('Curl Defining Cream');
                }
                if (answers.colorTreated === 'yes') {
                    recommendations.push('Color Protection Treatment');
                }
                
                return recommendations.length > 0 ? recommendations : ['Custom Hair Care Set'];
            };

            // Function to send results via LINE
            const sendResultsToLine = () => {
                if (!liffReady || typeof liff === 'undefined') {
                    alert('LIFF is not available. Please open this in LINE app.');
                    return;
                }

                const recommendations = getRecommendations();
                const message = 'Quiz Results:\n\n' + recommendations.join('\n');
                
                // Option 1: Send as text message
                liff.sendMessages([{
                    type: 'text',
                    text: message
                }])
                .then(() => {
                    console.log('Message sent');
                    liff.closeWindow();
                })
                .catch((err) => {
                    console.error('Error sending message', err);
                });
            };

            if (isComplete) {
                return (
                    <div style={{ 
                        minHeight: '100vh', 
                        background: COLORS.background,
                        padding: '20px'
                    }}>
                        <div style={{
                            maxWidth: '500px',
                            margin: '0 auto',
                            textAlign: 'center',
                            paddingTop: '40px'
                        }}>
                            <div style={{
                                width: '80px',
                                height: '80px',
                                borderRadius: '50%',
                                background: COLORS.primary,
                                margin: '0 auto 24px',
                                display: 'flex',
                                alignItems: 'center',
                                justifyContent: 'center'
                            }}>
                                <Package />
                            </div>
                            
                            <h2 style={{
                                fontSize: '28px',
                                fontWeight: 'bold',
                                color: COLORS.text,
                                marginBottom: '12px'
                            }}>
                                Your Perfect Match! ðŸŽ‰
                            </h2>
                            
                            <p style={{
                                color: COLORS.textLight,
                                fontSize: '16px',
                                marginBottom: '32px'
                            }}>
                                Based on your answers, here are your personalized recommendations
                            </p>

                            <div style={{
                                background: COLORS.cardBg,
                                borderRadius: '16px',
                                padding: '24px',
                                marginBottom: '24px',
                                textAlign: 'left'
                            }}>
                                <h3 style={{
                                    fontSize: '18px',
                                    fontWeight: 'bold',
                                    color: COLORS.text,
                                    marginBottom: '16px'
                                }}>
                                    Your Selections:
                                </h3>
                                {Object.entries(answers).map(([key, value]) => (
                                    <div key={key} style={{
                                        padding: '12px',
                                        background: COLORS.background,
                                        borderRadius: '8px',
                                        marginBottom: '8px',
                                        display: 'flex',
                                        justifyContent: 'space-between'
                                    }}>
                                        <span style={{ color: COLORS.textLight, textTransform: 'capitalize' }}>
                                            {key.replace(/([A-Z])/g, ' $1').trim()}:
                                        </span>
                                        <span style={{ color: COLORS.text, fontWeight: '600' }}>
                                            {value}
                                        </span>
                                    </div>
                                ))}
                            </div>

                            <div style={{
                                background: `linear-gradient(135deg, ${COLORS.primary}, ${COLORS.secondary})`,
                                borderRadius: '16px',
                                padding: '24px',
                                marginBottom: '24px',
                                color: 'white',
                                textAlign: 'left'
                            }}>
                                <h3 style={{
                                    fontSize: '18px',
                                    fontWeight: 'bold',
                                    marginBottom: '16px'
                                }}>
                                    Recommended Products:
                                </h3>
                                {getRecommendations().map((rec, idx) => (
                                    <div key={idx} style={{
                                        padding: '12px',
                                        background: 'rgba(255,255,255,0.2)',
                                        borderRadius: '8px',
                                        marginBottom: '8px'
                                    }}>
                                        {rec}
                                    </div>
                                ))}
                            </div>

                            <button
                                onClick={sendResultsToLine}
                                style={{
                                    width: '100%',
                                    padding: '16px',
                                    background: COLORS.primary,
                                    border: 'none',
                                    borderRadius: '12px',
                                    color: 'white',
                                    fontSize: '16px',
                                    fontWeight: '600',
                                    cursor: 'pointer',
                                    marginBottom: '12px'
                                }}
                            >
                                Send Results to Chat
                            </button>

                            <button
                                onClick={handleRestart}
                                style={{
                                    width: '100%',
                                    padding: '16px',
                                    background: COLORS.background,
                                    border: `2px solid ${COLORS.primary}`,
                                    borderRadius: '12px',
                                    color: COLORS.primary,
                                    fontSize: '16px',
                                    fontWeight: '600',
                                    cursor: 'pointer'
                                }}
                            >
                                Take Quiz Again
                            </button>
                        </div>
                    </div>
                );
            }

            const currentQuestion = quizData[currentQ];
            const progress = ((currentQ + 1) / quizData.length) * 100;

            return (
                <div style={{ 
                    minHeight: '100vh', 
                    background: COLORS.background,
                    padding: '0',
                    overflow: 'hidden'
                }}>
                    <div style={{
                        height: '4px',
                        background: '#E0E0E0',
                        position: 'relative'
                    }}>
                        <div style={{
                            height: '100%',
                            background: COLORS.primary,
                            width: `${progress}%`,
                            transition: 'width 0.3s ease'
                        }} />
                    </div>

                    <div style={{
                        padding: '16px 20px',
                        background: COLORS.background,
                        borderBottom: '1px solid #E0E0E0'
                    }}>
                        <span style={{
                            fontSize: '14px',
                            color: COLORS.textLight,
                            fontWeight: '600'
                        }}>
                            Question {currentQ + 1} of {quizData.length}
                        </span>
                    </div>

                    <div style={{
                        width: '100%',
                        height: '240px',
                        overflow: 'hidden',
                        background: '#f0f0f0'
                    }}>
                        <img 
                            src={currentQuestion.image} 
                            alt="Question visual"
                            style={{
                                width: '100%',
                                height: '100%',
                                objectFit: 'cover'
                            }}
                        />
                    </div>

                    <div style={{ padding: '24px 20px' }}>
                        <h2 style={{
                            fontSize: '24px',
                            fontWeight: 'bold',
                            color: COLORS.text,
                            marginBottom: '24px',
                            lineHeight: '1.3'
                        }}>
                            {currentQuestion.question}
                        </h2>

                        <div style={{ marginBottom: '80px' }}>
                            {currentQuestion.options.map((option) => (
                                <button
                                    key={option.id}
                                    onClick={() => handleOptionSelect(option)}
                                    style={{
                                        width: '100%',
                                        padding: '18px 20px',
                                        marginBottom: '12px',
                                        background: selectedOption === option.id ? COLORS.primary : COLORS.cardBg,
                                        border: selectedOption === option.id ? `2px solid ${COLORS.primary}` : '2px solid transparent',
                                        borderRadius: '12px',
                                        color: selectedOption === option.id ? 'white' : COLORS.text,
                                        fontSize: '16px',
                                        fontWeight: '600',
                                        cursor: 'pointer',
                                        transition: 'all 0.2s ease',
                                        textAlign: 'left',
                                        display: 'flex',
                                        alignItems: 'center',
                                        justifyContent: 'space-between'
                                    }}
                                >
                                    <span>{option.label}</span>
                                    {selectedOption === option.id && (
                                        <div style={{
                                            width: '24px',
                                            height: '24px',
                                            borderRadius: '50%',
                                            background: 'white',
                                            display: 'flex',
                                            alignItems: 'center',
                                            justifyContent: 'center'
                                        }}>
                                            <div style={{
                                                width: '12px',
                                                height: '12px',
                                                borderRadius: '50%',
                                                background: COLORS.primary
                                            }} />
                                        </div>
                                    )}
                                </button>
                            ))}
                        </div>
                    </div>

                    <div style={{
                        position: 'fixed',
                        bottom: 0,
                        left: 0,
                        right: 0,
                        padding: '16px 20px',
                        background: COLORS.background,
                        borderTop: '1px solid #E0E0E0'
                    }}>
                        <button
                            onClick={handleNext}
                            disabled={!selectedOption}
                            style={{
                                width: '100%',
                                padding: '16px',
                                background: selectedOption ? COLORS.primary : '#E0E0E0',
                                border: 'none',
                                borderRadius: '12px',
                                color: 'white',
                                fontSize: '16px',
                                fontWeight: '600',
                                cursor: selectedOption ? 'pointer' : 'not-allowed',
                                display: 'flex',
                                alignItems: 'center',
                                justifyContent: 'center',
                                gap: '8px',
                                transition: 'all 0.2s ease'
                            }}
                        >
                            {currentQ === quizData.length - 1 ? 'See Results' : 'Next'}
                            <ChevronRight />
                        </button>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<SkinCareQuiz />);
    </script>
</body>
</html>
